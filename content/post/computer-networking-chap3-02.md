---
title: "计算机网络 Chap3 02：多路复用和多路分解"
date: 2021-04-26T17:56:55+08:00
categories: ["Computer Networking"]
tags: ["计算机网络：自顶向下方法"]
draft: false
---

多路复用和多路分解可以将网络层提供的主机到主机的交付服务扩展到为运行在主机上的应用提供进程到进程交付服务。

需要强调的是，多路复用 / 多路分解服务对所有计算机网络来说都是必需的。

进程有一个或多个套接字，数据通过套接字从网络传递给进程和从进程传递给网络。每个套接字都有唯一的标识符，格式取决于传输层协议。

<!--more-->

在接收端，传输层检查报文段中的特殊字段，来标识接收套接字并将报文段定向到该套接字。

多路分解：将传输层报文段中的数据交付到正确的套接字。

多路复用：从源主机的多个套接字收集数据块，每个数据块与首部信息一起封装为报文段，并将报文段传递给网络层。

报文段中的特殊字段是源端口号字段（source port number field）和目的地端口号字段（destination port number field）。每个端口号是一个 16 比特的数字，范围从 0 到 65535。

从 0 到 1023 的端口号称为周知端口号（well-known port number），受到限制，保留给如 HTTP（端口号 80）和 FTP（端口号 21）之类的周知应用层协议使用。

主机中的每个套接字都有一个端口号，当报文段到达主机时，传输层检查报文段中的目的地端口号，将报文段定向到对应套接字。报文段中的数据通过套接字进入所连接的进程。

---

一个 UDP 套接字由一个二元组完全标识，二元组包含一个目的地 IP 地址和目的地端口号。

只要几个 UDP 报文段中目的地 IP 地址和目的地端口号相同，它们就会被同一目的地套接字定向到同一目的地进程。

源端口号在目的地主机发送回复报文时使用。

---

一个 TCP 套接字由一个四元组标识，四元组包括源 IP 地址、源端口号、目的地 IP 地址和目的地端口号。

具有不同源 IP 地址或源端口号的 TCP 报文段会被定向到不同套接字，除非 TCP 报文段携带了初始连接建立请求。

---

客户端发送报文段给 Web 服务器时，所有报文段的目的地端口号都是 80。服务器通过源 IP 地址和源端口号来区分不同客户端。

Web 服务器为每个连接生成一个进程。每个进程都有自己的连接套接字。

现在的高性能 Web 服务器则通常只有一个进程，为每个客户端连接创建一个新线程和新的连接套接字。