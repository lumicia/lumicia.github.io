---
title: "Python 正则表达式语法"
date: 2021-06-20T12:43:35+08:00
categories: ["Python"]
tags: ["正则表达式"]
draft: false
---

正则表达式指定了一系列与之匹配的字符串。通过 `re` 模块中的函数可以检验某个字符串是否与给定的正则表达式匹配。

正则表达式可以包含普通或特殊字符。普通字符的正则表达式可以匹配它自身构成的字符串。特殊字符可以表示它自身，也可以影响它旁边的正则表达式的解释。

<!--more-->

特殊字符：

- `.`：匹配换行符以外的任意字符。指定 `DOTALL` 标志，则匹配时可以将换行符包括进来。
- `^`：匹配字符串开头。指定 `MULTILINE` 标志，则可以匹配换行后的起始符号。
- `$`：匹配字符结尾，或字符串结尾换行符的前一个字符。指定 `MULTILINE` 标志，则可以匹配换行符之前的文本。
- `*`：匹配零到多次。非贪婪版本 `*?`。
- `+`：匹配一到多次。非贪婪版本 `+?`。
- `?`：匹配零到一次。非贪婪版本 `??`。
- `{m}`：匹配 `m` 次。
- `{m, n}`：匹配 `m` 到 `n` 次。忽略 `m`，则下界为 `0`；忽略 `n`，则上界为无限次。非贪婪版本 `{m, n}?`。
- `\`：转义字符。
- `[]`：表示字符集合。可以表示单个字符；表示字符范围，用 `-` 将两个字符相连；表示特殊字符的字面意义；表示字符类；对不在集合范围内的字符通过取反来匹配；匹配 `[`、`]`、`--`、`&&`、`~~` 和 `||` 时需要用到反斜杠；
- `|`：匹配符号两边任一正则表达式。短路匹配。匹配 `|` 符号可以使用 `\|` 或 `[|]`。
- `(...)`：匹配括号内的任意正则表达式，并标识出分组的开始和结尾。匹配完成后，可以获取分组的内容。
- `(?...)`：扩展标记法。
- `(?aiLmsux)`：设置字符一到多个，这个分组匹配一个空字符串，只是为了设置标志。应该放在表达式字符开头。
- `(?:...)`：匹配括号内的任意正则表达式，但匹配得到的子字符串不能被获取或在之后的模式中引用。
- `(?aiLmsux-imsx:...)`：设置字符零到多个，之后可选跟随在 `-` 后的字符一到多个。设置标志，或去除标志。
- `(?P<name>...)`：命名分组。匹配到的子串分组在外部通过定义的 `name` 来获取。分组名必须是有效的 Python 标识符，并且每个分组名只能用一个正则表达式定义，只能定义一次。
- `(?P=name)`：反向引用一个命名分组，匹配前面的 `name` 命名分组中匹配到的子串。
- `(?#...)`：注释。
- `(?=...)`：匹配 `...` 的内容，但不消费模式的内容，即被匹配的文本不包含在最终返回的匹配结果里。称为先行断言（lookahead assertion）。由于返回结果的字节长度永远是 0，因此也称为零宽度匹配操作。
- `(?!...)`：负向先行断言
- `(?<=...)`：后行断言。必须匹配定长的模式。
- `(?<!...)`：负向后行断言。必须匹配定长的模式。
- `(?(id/name)yes-pattern|no-pattern)`：如果给定的 `id` 或 `name` 存在，则尝试匹配 `yes-pattern`，否则匹配 `no-pattern`。`no-pattern` 可选，也可忽略。

转义特殊序列：

- `\number`：匹配用数字表示的分组。从 `1` 到 `99`。
- `\A`：匹配字符串开头。`?m` 对其无效。
- `\b`：匹配仅在单词开始或结尾的位置的空字符串。
- `\B`：匹配不在单词开始或结尾的位置的空字符串。
- `\d`：匹配 Unicode 十进制数字，类似于 `[0-9]`。
- `\D`：匹配非十进制数字，类似于 `[^0-9]`。
- `\s`：匹配 Unicode 空字符，类似于 `[\t\n\r\f\v]`。
- `\S`：匹配非空字符，类似于 `[^ \t\n\r\f\v]`。
- `\w`：匹配 Unicode 单词字符，类似于 `[a-zA-Z0-9_]`。
- `\W`：匹配非单词字符，类似于 `[^a-zA-Z0-9]`。
- `\Z`：匹配字符串结尾。`?m` 对其无效。

